<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Interacción con modelos GPT usando Structured Outputs — acep_gpt • ACEP</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Interacción con modelos GPT usando Structured Outputs — acep_gpt"><meta name="description" content="Función para interactuar con la API de OpenAI utilizando Structured Outputs,
una funcionalidad que garantiza respuestas en formato JSON que cumplen estrictamente
con un esquema predefinido. Esto elimina la necesidad de parseo y validación manual,
haciendo las respuestas más confiables y estructuradas. Compatible con modelos
`gpt-4o` y `gpt-4o-mini`."><meta property="og:description" content="Función para interactuar con la API de OpenAI utilizando Structured Outputs,
una funcionalidad que garantiza respuestas en formato JSON que cumplen estrictamente
con un esquema predefinido. Esto elimina la necesidad de parseo y validación manual,
haciendo las respuestas más confiables y estructuradas. Compatible con modelos
`gpt-4o` y `gpt-4o-mini`."><meta property="og:image" content="https://agusnieto77.github.io/ACEP/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ACEP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/conflictividad_soip.html">Conflictividad laboral en la pesca</a></li>
    <li><a class="dropdown-item" href="../articles/extraccion_de_svo_con_acep.html">Extraer S-V-O con ACEP</a></li>
    <li><a class="dropdown-item" href="../articles/extraccion_palabras_clave.html">Extracción de palabas clave</a></li>
    <li><a class="dropdown-item" href="../articles/limpieza_de_texto_con_acep.html">Limpieza de texto con ACEP</a></li>
    <li><a class="dropdown-item" href="../articles/tokenizar_con_acep.html">Tokenizar con ACEP</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/agusnieto77/ACEP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Interacción con modelos GPT usando Structured Outputs</h1>
      <small class="dont-index">Source: <a href="https://github.com/agusnieto77/ACEP/blob/master/R/acep_gpt.R" class="external-link"><code>R/acep_gpt.R</code></a></small>
      <div class="d-none name"><code>acep_gpt.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Función para interactuar con la API de OpenAI utilizando Structured Outputs,
una funcionalidad que garantiza respuestas en formato JSON que cumplen estrictamente
con un esquema predefinido. Esto elimina la necesidad de parseo y validación manual,
haciendo las respuestas más confiables y estructuradas. Compatible con modelos
`gpt-4o` y `gpt-4o-mini`.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">acep_gpt</span><span class="op">(</span></span>
<span>  <span class="va">texto</span>,</span>
<span>  <span class="va">instrucciones</span>,</span>
<span>  modelo <span class="op">=</span> <span class="st">"gpt-4o-mini"</span>,</span>
<span>  api_key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"OPENAI_API_KEY"</span><span class="op">)</span>,</span>
<span>  schema <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parse_json <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  temperature <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  max_tokens <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  top_p <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  frequency_penalty <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123456</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-texto">texto<a class="anchor" aria-label="anchor" href="#arg-texto"></a></dt>
<dd><p>Texto a analizar con GPT. Puede ser una noticia, tweet, documento, etc.</p></dd>


<dt id="arg-instrucciones">instrucciones<a class="anchor" aria-label="anchor" href="#arg-instrucciones"></a></dt>
<dd><p>Instrucciones en lenguaje natural que indican al modelo qué hacer
con el texto. Ejemplo: "Extrae todas las entidades nombradas", "Clasifica el sentimiento".</p></dd>


<dt id="arg-modelo">modelo<a class="anchor" aria-label="anchor" href="#arg-modelo"></a></dt>
<dd><p>Modelo de OpenAI a utilizar. Opciones: `"gpt-4o-mini"` (más rápido y económico),
`"gpt-4o"` (más potente), `"gpt-4o-2024-08-06"`, `"gpt-4o-2024-11-20"`. Por defecto: `"gpt-4o-mini"`.</p></dd>


<dt id="arg-api-key">api_key<a class="anchor" aria-label="anchor" href="#arg-api-key"></a></dt>
<dd><p>Clave de API de OpenAI. Si no se proporciona, busca la variable de
entorno `OPENAI_API_KEY`. Para obtener una clave: https://platform.openai.com/api-keys</p></dd>


<dt id="arg-schema">schema<a class="anchor" aria-label="anchor" href="#arg-schema"></a></dt>
<dd><p>Esquema JSON que define la estructura de la respuesta. Puede usar
`acep_gpt_schema()` para obtener esquemas predefinidos o crear uno personalizado.
Si es `NULL`, usa un esquema simple con campo "respuesta".</p></dd>


<dt id="arg-parse-json">parse_json<a class="anchor" aria-label="anchor" href="#arg-parse-json"></a></dt>
<dd><p>Lógico. Si `TRUE` (por defecto), parsea automáticamente el JSON
a un objeto R (lista o data frame). Si `FALSE`, devuelve el JSON como string.</p></dd>


<dt id="arg-temperature">temperature<a class="anchor" aria-label="anchor" href="#arg-temperature"></a></dt>
<dd><p>Parámetro de temperatura (0-2). Valores bajos (0-0.3) generan
respuestas más deterministas y consistentes. Valores altos (0.7-1) más creativas.
Por defecto: 0 (máxima determinismo).</p></dd>


<dt id="arg-max-tokens">max_tokens<a class="anchor" aria-label="anchor" href="#arg-max-tokens"></a></dt>
<dd><p>Número máximo de tokens en la respuesta. Por defecto: 2000.</p></dd>


<dt id="arg-top-p">top_p<a class="anchor" aria-label="anchor" href="#arg-top-p"></a></dt>
<dd><p>Parámetro top-p para nucleus sampling (0-1). Controla la diversidad
de la respuesta. Por defecto: 0.2.</p></dd>


<dt id="arg-frequency-penalty">frequency_penalty<a class="anchor" aria-label="anchor" href="#arg-frequency-penalty"></a></dt>
<dd><p>Penalización por repetición de tokens frecuentes (-2 a 2).
Por defecto: 0.2.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Semilla numérica para reproducibilidad. Usar el mismo seed con los
mismos parámetros genera respuestas idénticas. Por defecto: 123456.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Si `parse_json=TRUE`, devuelve una lista o data frame con la respuesta
  estructurada según el esquema. Si `parse_json=FALSE`, devuelve un string JSON.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Extraer entidades de un texto</span></span></span>
<span class="r-in"><span><span class="va">texto</span> <span class="op">&lt;-</span> <span class="st">"El SUTEBA convocó a un paro en Buenos Aires el 15 de marzo."</span></span></span>
<span class="r-in"><span><span class="va">instrucciones</span> <span class="op">&lt;-</span> <span class="st">"Extrae todas las entidades nombradas del texto."</span></span></span>
<span class="r-in"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="acep_gpt_schema.html">acep_gpt_schema</a></span><span class="op">(</span><span class="st">"extraccion_entidades"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resultado</span> <span class="op">&lt;-</span> <span class="fu">acep_gpt</span><span class="op">(</span><span class="va">texto</span>, <span class="va">instrucciones</span>, schema <span class="op">=</span> <span class="va">schema</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">resultado</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Análisis de sentimiento</span></span></span>
<span class="r-in"><span><span class="va">texto</span> <span class="op">&lt;-</span> <span class="st">"La protesta fue pacífica y bien organizada."</span></span></span>
<span class="r-in"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="acep_gpt_schema.html">acep_gpt_schema</a></span><span class="op">(</span><span class="st">"sentimiento"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resultado</span> <span class="op">&lt;-</span> <span class="fu">acep_gpt</span><span class="op">(</span><span class="va">texto</span>, <span class="st">"Analiza el sentimiento del texto"</span>, schema <span class="op">=</span> <span class="va">schema</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">resultado</span><span class="op">$</span><span class="va">sentimiento_general</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Clasificar noticia</span></span></span>
<span class="r-in"><span><span class="va">texto</span> <span class="op">&lt;-</span> <span class="st">"Trabajadores reclamaron mejoras salariales."</span></span></span>
<span class="r-in"><span><span class="va">schema</span> <span class="op">&lt;-</span> <span class="fu"><a href="acep_gpt_schema.html">acep_gpt_schema</a></span><span class="op">(</span><span class="st">"clasificacion"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">resultado</span> <span class="op">&lt;-</span> <span class="fu">acep_gpt</span><span class="op">(</span><span class="va">texto</span>, <span class="st">"Clasifica esta noticia"</span>, schema <span class="op">=</span> <span class="va">schema</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">resultado</span><span class="op">$</span><span class="va">categoria</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Agustín Nieto.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

